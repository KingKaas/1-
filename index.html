<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>🔤 احزر الكلمة من الوصف</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { background:#111;color:#fff;font-family:Arial, sans-serif;text-align:center;direction:rtl;margin:0;padding:0;}
    h1 { margin:20px 12px; }
    .top-bar{display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;margin-bottom:8px}
    #hint{font-size:20px}
    #emojiResult{font-size:42px;line-height:1}
    #score{font-size:18px;margin-bottom:4px;color:#00d000}
    #reaction{min-height:28px;margin:6px 0 4px 0;font-size:18px;opacity:.95}
    #wordBoxes{display:flex;justify-content:center;gap:10px;margin:12px 0}
    .letter-box{width:40px;height:40px;background:#333;border:2px solid #fff;font-size:24px;display:flex;justify-content:center;align-items:center}
    #keyboard{display:flex;flex-wrap:wrap;max-width:420px;margin:0 auto;justify-content:center}
    .key{width:40px;height:40px;margin:4px;background:#444;color:#fff;font-size:18px;border:none;border-radius:5px;cursor:pointer}
    .key:disabled{background:#666;cursor:not-allowed}
    #attempts{margin:10px}
    .ball{width:20px;height:20px;border-radius:50%;display:inline-block;margin:3px;background:green}
    .used{background:red}
    #nextBtn,#restartBtn{margin-top:15px;padding:10px 20px;color:#fff;border:none;border-radius:8px;font-size:18px;cursor:pointer;display:none}
    #nextBtn{background:#2196F3}
    #restartBtn{background:#4CAF50}
    #gameOverPanel{display:none;margin:20px auto 0 auto;background:#222;border:1px solid #333;border-radius:12px;padding:16px;width:min(520px,92%)}
    #gameOverPanel h2{margin:8px 0 12px}
  </style>
</head>
<body>

<h1>🔤 احزر الكلمة من الوصف</h1>
<div id="score">النقاط: 0</div>

<div class="top-bar">
  <div id="hint"></div>
  <div id="emojiResult"></div>
</div>

<div id="reaction"></div>

<div id="wordBoxes"></div>
<div id="attempts"></div>
<div id="keyboard"></div>

<button id="nextBtn">➡️ السؤال التالي</button>

<div id="gameOverPanel">
  <h2>🏁 نهاية اللعبة</h2>
  <div id="finalEmoji" style="font-size:48px;margin-bottom:8px;">😢</div>
  <div id="stats"></div>
  <button id="restartBtn">🔄 ابدأ لعبة جديدة</button>
</div>

<script>
  const levels = {
    3:[{word:"قلم",hint:"شيء نستخدمه للكتابة"},{word:"كنز",hint:"شيء تجده بإستخدام الخريطة"},
       {word:"باب",hint:"نفتحه للدخول والخروج"},{word:"فم",hint:"نستخدمه للأكل والكلام"},
       {word:"يد",hint:"نستخدمها للمس والإمساك"},{word:"عين",hint:"نرى بها"},
       {word:"أم",hint:"هي من أنجبتك"},{word:"دم",hint:"سائل أحمر في الجسم"},
       {word:"بيت",hint:"مكان السكن"},{word:"نور",hint:"ضد الظلام"},
       {word:"جبل",hint:"مرتفع في الأرض"},{word:"نار",hint:"حارة وتحرق"},
       {word:"سر",hint:"شيء لا يُقال"},{word:"فن",hint:"نوع من الإبداع"},
       {word:"لبن",hint:"مشروب أبيض من الحليب"},{word:"حوت",hint:"أكبر كائن بحري"}],
    4:[{word:"سماء",hint:"فوقنا زرقاء"},{word:"كتاب",hint:"نقرأ فيه"},{word:"شمس",hint:"تضيء وتدفئ"},
       {word:"مطر",hint:"ينزل من السحاب"},{word:"بحر",hint:"ماء مالح واسع"},{word:"ورق",hint:"نكتب عليه"},
       {word:"طين",hint:"تراب مبلل"},{word:"طريق",hint:"نسير عليه"},{word:"لباس",hint:"ما نرتديه"},
       {word:"قفل",hint:"نستخدمه للإغلاق"},{word:"وقت",hint:"الزمن"},{word:"درب",hint:"ممشى أو طريق صغير"},
       {word:"شاي",hint:"مشروب ساخن"},{word:"عود",hint:"يُستخدم للتبخير"},{word:"حجر",hint:"جماد صلب"}],
    5:[{word:"مفتاح",hint:"لفتح الأقفال"},{word:"مدرسة",hint:"مكان التعليم"},{word:"سيارة",hint:"وسيلة نقل"},
       {word:"نافذة",hint:"تُفتح في الجدار"},{word:"جريدة",hint:"نقرأ فيها الأخبار"},{word:"مطار",hint:"مكان الطائرات"},
       {word:"مكتب",hint:"نستخدمه للعمل"},{word:"جزيرة",hint:"أرض في وسط الماء"},{word:"رصيف",hint:"مكان انتظار المشاة"},
       {word:"مشروب",hint:"يُشرب بارد أو ساخن"},{word:"بوابة",hint:"مدخل كبير"},{word:"قصيدة",hint:"نص شعري"},
       {word:"بركان",hint:"جبل يثور نارًا"},{word:"برنامج",hint:"نستخدمه بالحاسوب"},{word:"أوراق",hint:"جمع ورقة"}],
    6:[{word:"حاسوب",hint:"جهاز إلكتروني ذكي"},{word:"تمثال",hint:"نحت لشخص أو شيء"},{word:"مهندس",hint:"يُصمم المباني أو الأنظمة"},
       {word:"مطبخ",hint:"مكان الطبخ"},{word:"حديقة",hint:"مكان به زرع"},{word:"مكتبة",hint:"مكان لحفظ الكتب"},
       {word:"مطعم",hint:"مكان تقديم الطعام"},{word:"مسجد",hint:"مكان الصلاة للمسلمين"},{word:"بطاقة",hint:"تُستخدم للتعريف أو الدفع"},
       {word:"مدينة",hint:"مكان كبير للعيش"},{word:"مساعدة",hint:"تقديم العون"},{word:"مشترك",hint:"يشارك الآخرين"},
       {word:"موهبة",hint:"قدرة فطرية خاصة"},{word:"مزرعة",hint:"أرض لزراعة الطعام"},{word:"مشكلة",hint:"تحتاج لحل"}],
    7:[{word:"مستشفى",hint:"مكان لعلاج المرضى"},{word:"استعارة",hint:"أخذ شيء مؤقتًا"},{word:"بطارية",hint:"مصدر طاقة كهربائية"},
       {word:"تلسكوب",hint:"أداة لرؤية الأجسام البعيدة"},{word:"انترنت",hint:"شبكة عالمية للمعلومات"},
       {word:"ثقافة",hint:"مجموعة من المعارف والقيم"},{word:"محفظة",hint:"تُستخدم لحمل النقود"},
       {word:"منطقة",hint:"جزء من الأرض له حدود"},{word:"جمهوري",hint:"يتبع نظامًا غير ملكي"},
       {word:"تجربة",hint:"محاولة لاكتشاف شيء"},{word:"مزارع",hint:"يعمل في الزراعة"},{word:"مشترك",hint:"يشارك فيه أكثر من شخص"},
       {word:"مفتوحة",hint:"غير مغلقة"},{word:"فاصوليا",hint:"نوع من الخضروات"},{word:"تقويم",hint:"نظام لترتيب الأيام"}],
    8:[{word:"مكتسبة",hint:"تم الحصول عليها"},{word:"اقتصادي",hint:"يتعلق بالمال والتجارة"},{word:"مترجم",hint:"ينقل المعنى بين لغتين"},
       {word:"مغناطيس",hint:"يجذب الأشياء المعدنية"},{word:"تكنولوجيا",hint:"علم وفن التطبيق العملي"},
       {word:"محاكمة",hint:"إجراء قانوني للبت بقضية"},{word:"مواجهة",hint:"الوقوف أمام تحدّ"},
       {word:"إستراتيجية",hint:"خطة لتحقيق هدف بعيد المدى"},{word:"تساؤلات",hint:"أسئلة متعددة"},
       {word:"مسؤولية",hint:"واجب الالتزام أو التصرف"},{word:"تسويق",hint:"عملية الترويج لمنتج"},
       {word:"مراسلة",hint:"تبادل الرسائل"},{word:"ترجمة",hint:"نقل نص من لغة لأخرى"},
       {word:"معادلة",hint:"توازن رياضي أو منطقي"},{word:"مغادرة",hint:"ترك المكان أو الرحيل"}],
    9:[{word:"استئذان",hint:"طلب السماح قبل الفعل"},{word:"استفهام",hint:"طلب معرفة شيء"},{word:"استعداد",hint:"جاهزية لفعل شيء"},
       {word:"معلومات",hint:"تفاصيل ومعرفة عن شيء"},{word:"مقارنة",hint:"موازنة بين شيئين"},
       {word:"مغامرات",hint:"أحداث مشوقة وخطيرة"},{word:"استقبال",hint:"استلام ضيف أو رسالة"},
       {word:"متفوقين",hint:"حققوا نجاحًا مميزًا"},{word:"المهارات",hint:"قدرات مكتسبة"},
       {word:"التقارير",hint:"وثائق تتضمن معلومات"},{word:"استثمار",hint:"تشغيل المال لتحقيق ربح"},
       {word:"المواصلات",hint:"وسائل النقل"},{word:"استجمام",hint:"راحة وتجديد نشاط"},
       {word:"المكتبات",hint:"أماكن لحفظ واستعارة الكتب"},{word:"استجابة",hint:"رد الفعل على طلب"}]
  };

  const pointsPerLength = {3:5,4:10,5:15,6:20,7:25,8:30,9:35};

  // رسائل تشجيعية/مضحكة
  const msgsRight = [
    "أيوه يا زعيم! 👏", "انت بتذاكر من ورانا؟ 🤓", "الله عليك!🔥",
    "تعال أبخّرك من العين 😉", "إبداع يا فنان! 🎨", "مظبوووط ✅"
  ];
  const msgsWrong = [
    "الله مالك! 😅", "حد عاملك عمل؟ 🧿", "البس نظارة 🤓",
    "قلبها صح بتجي! 💪", "قريب توصلها، ركّز شوي 👀", "لا تحاتّي، حاول مرة ثانية 🔁"
  ];
  const rnd = a => a[Math.floor(Math.random()*a.length)];

  // حالة اللعبة
  let availableWords=[], currentWord={}, guessedLetters=[];
  const maxAttempts=5;
  let wrongAttempts=0, score=0, totalAnswered=0, totalCorrect=0;

  const letters="أبجدهوزحطيكلمنسعفصقرشتثخذضظغئءؤىةلا";
  const hintEl=document.getElementById("hint");
  const wordBoxes=document.getElementById("wordBoxes");
  const keyboard=document.getElementById("keyboard");
  const attemptsEl=document.getElementById("attempts");
  const scoreEl=document.getElementById("score");
  const nextBtn=document.getElementById("nextBtn");
  const emojiResult=document.getElementById("emojiResult");
  const reaction=document.getElementById("reaction");
  const gameOverPanel=document.getElementById("gameOverPanel");
  const statsEl=document.getElementById("stats");
  const finalEmoji=document.getElementById("finalEmoji");
  const restartBtn=document.getElementById("restartBtn");

  function fillAvailableWords(){
    availableWords=[];
    for (let len in levels) availableWords=availableWords.concat(levels[len]);
  }

  function setupWord(word){
    wordBoxes.innerHTML="";
    for(let i=0;i<word.length;i++){
      const box=document.createElement("div");
      box.className="letter-box";
      box.id=`box-${i}`;
      wordBoxes.appendChild(box);
    }
  }

  function setupAttempts(){
    attemptsEl.innerHTML="";
    for(let i=0;i<maxAttempts;i++){
      const ball=document.createElement("div");
      ball.className="ball";
      ball.id=`ball-${i}`;
      attemptsEl.appendChild(ball);
    }
  }

  function setupKeyboard(){
    keyboard.innerHTML="";
    letters.split("").forEach(letter=>{
      const btn=document.createElement("button");
      btn.className="key";
      btn.textContent=letter;
      btn.onclick=()=>handleGuess(letter, btn);
      keyboard.appendChild(btn);
    });
  }

  function handleGuess(letter, btn){
    btn.disabled=true;
    let found=false;

    for(let i=0;i<currentWord.word.length;i++){
      if(currentWord.word[i]===letter){
        guessedLetters[i]=letter;
        document.getElementById(`box-${i}`).textContent=letter;
        found=true;
      }
    }

    if(!found){
      reaction.textContent = rnd(msgsWrong);
      document.getElementById(`ball-${wrongAttempts}`).classList.add("used");
      wrongAttempts++;
      if(wrongAttempts>=maxAttempts){
        endGame(false, true); // تنهي اللعبة كلها
      }
    }else{
      reaction.textContent = rnd(msgsRight);
      if(guessedLetters.join("")===currentWord.word){
        endGame(true, false);
      }
    }
  }

  // endGame(success, isGameOverNow)
  function endGame(success, isGameOverNow){
    document.querySelectorAll(".key").forEach(btn=>btn.disabled=true);
    totalAnswered++;

    if(success){
      const add=pointsPerLength[currentWord.word.length]||0;
      score+=add; totalCorrect++;
      scoreEl.textContent=`النقاط: ${score}`;
      if(wrongAttempts===0) emojiResult.textContent="👑";
      else if(wrongAttempts<=2) emojiResult.textContent="😀";
      else if(wrongAttempts<=4) emojiResult.textContent="🤡";
    }else{
      emojiResult.textContent="😢";
    }

    if(isGameOverNow){
      showGameOver();
    }else{
      nextBtn.style.display="inline-block";
    }
  }

  function showGameOver(){
    nextBtn.style.display="none";
    keyboard.innerHTML="";
    finalEmoji.textContent="😢";
    statsEl.innerHTML = `
      <div id="finalScore">المجموع النهائي: <b>${score}</b> نقطة</div>
      <div>عدد الأسئلة الصحيحة: <b>${totalCorrect}</b></div>
      <div>إجمالي الأسئلة المجابة: <b>${totalAnswered}</b></div>
    `;
    gameOverPanel.style.display="block";
    restartBtn.style.display="inline-block";   // ← إصلاح: إظهار زر الإعادة
  }

  function resetAll(){
    score=0; totalAnswered=0; totalCorrect=0; wrongAttempts=0;
    emojiResult.textContent=""; reaction.textContent="";
    scoreEl.textContent="النقاط: 0";
    gameOverPanel.style.display="none";
    restartBtn.style.display="none";
    nextBtn.style.display="none";
    fillAvailableWords();
    startGame();
  }

  function startGame(){
    reaction.textContent="";
    emojiResult.textContent="";
    if(availableWords.length===0){ showGameOver(); return; }

    const idx=Math.floor(Math.random()*availableWords.length);
    currentWord=availableWords.splice(idx,1)[0];
    guessedLetters=new Array(currentWord.word.length).fill("");
    wrongAttempts=0;
    nextBtn.style.display="none";
    hintEl.textContent=currentWord.hint;

    setupWord(currentWord.word);
    setupAttempts();
    setupKeyboard();
  }

  nextBtn.onclick=startGame;
  restartBtn.onclick=resetAll;

  fillAvailableWords();
  startGame();
</script>
</body>
</html>

